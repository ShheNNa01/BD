-- Crear la base de datos
CREATE DATABASE SeguridadBancaria;
GO

-- Usar la base de datos creada
USE SeguridadBancaria;
GO

-- Tabla de Entidades Bancarias
CREATE TABLE EntidadBancaria (
    CodigoEntidad INT PRIMARY KEY,
    DomicilioCentral NVARCHAR(255)
);

-- Tabla de Sucursales
CREATE TABLE Sucursal (
    CodigoSucursal INT PRIMARY KEY,
    Domicilio NVARCHAR(255),
    NumeroEmpleados INT,
    CodigoEntidad INT,
    FOREIGN KEY (CodigoEntidad) REFERENCES EntidadBancaria(CodigoEntidad)
);

-- Tabla de Vigilantes
CREATE TABLE Vigilante (
    CodigoVigilante INT PRIMARY KEY,
    Edad INT
);

-- Tabla de Contrataciones de Vigilantes
CREATE TABLE ContratacionVigilante (
    CodigoSucursal INT,
    CodigoVigilante INT,
    FechaContratacion DATE,
    ConArma BIT,
    PRIMARY KEY (CodigoSucursal, CodigoVigilante, FechaContratacion),
    FOREIGN KEY (CodigoSucursal) REFERENCES Sucursal(CodigoSucursal),
    FOREIGN KEY (CodigoVigilante) REFERENCES Vigilante(CodigoVigilante)
);

-- Tabla de Personas Detenidas
CREATE TABLE PersonaDetenida (
    CodigoPersona INT PRIMARY KEY,
    Nombre NVARCHAR(100),
    Apellido NVARCHAR(100),
    Edad INT,
    DireccionCasa NVARCHAR(255),
    Barrio NVARCHAR(100)
);

-- Tabla de Bandas Organizadas
CREATE TABLE BandaOrganizada (
    NumeroBanda INT PRIMARY KEY,
    NumeroMiembros INT
);

-- Tabla de Pertenencia a Bandas
CREATE TABLE PertenenciaBanda (
    CodigoPersona INT,
    NumeroBanda INT,
    PRIMARY KEY (CodigoPersona, NumeroBanda),
    FOREIGN KEY (CodigoPersona) REFERENCES PersonaDetenida(CodigoPersona),
    FOREIGN KEY (NumeroBanda) REFERENCES BandaOrganizada(NumeroBanda)
);

-- Tabla de Atracos
CREATE TABLE Atraco (
    CodigoPersona INT,
    CodigoSucursal INT,
    FechaAtraco DATE,
    ValorPromedio DECIMAL(18, 2),
    PRIMARY KEY (CodigoPersona, CodigoSucursal, FechaAtraco),
    FOREIGN KEY (CodigoPersona) REFERENCES PersonaDetenida(CodigoPersona),
    FOREIGN KEY (CodigoSucursal) REFERENCES Sucursal(CodigoSucursal)
);

-- Tabla de Jueces
CREATE TABLE Juez (
    ClaveJuzgado INT PRIMARY KEY,
    Nombre NVARCHAR(100),
    AnosServicio INT
);

-- Tabla de Juicios
CREATE TABLE Juicio (
    CodigoPersona INT,
    ClaveJuzgado INT,
    CodigoSucursal INT,
    FechaAtraco DATE,
    Condenado BIT,
    TiempoCarcel INT,
    PRIMARY KEY (CodigoPersona, ClaveJuzgado, CodigoSucursal, FechaAtraco),
    FOREIGN KEY (CodigoPersona, CodigoSucursal, FechaAtraco) REFERENCES Atraco(CodigoPersona, CodigoSucursal, FechaAtraco),
    FOREIGN KEY (ClaveJuzgado) REFERENCES Juez(ClaveJuzgado)
);